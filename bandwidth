for A in $(ls -l /home/master/applications/| awk '/^d/ {print $NF}'); do echo "" > total.txt ; echo $A && awk 'NR==1 {print substr($NF, 1, length($NF)-1)}' /home/master/applications/$A/conf/server.nginx ;for i in {30..0}; do zcat -f /home/master/applications/$A/logs/*_*.access.log*| awk -v day="$(date --date="$i days ago" '+%d/%b/%Y')" '$4 ~ day {sum += $10} END {print sum >> "total.txt" ; printf("%s %.3f %s\n", day, sum/1024/1024, "MB")}';done;awk '{total +=$1} END {printf ("%s %.3f %s\n", "Total:", total/1024/1024/1024, "GB")}' total.txt;done
